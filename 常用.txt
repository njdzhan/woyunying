--新架构
----按人未处理工单量
select user_nick,count(*) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and end_date is null group by user_nick;
----按人未处理工单量，增加专业
select systype2_name,user_nick,count(*) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and end_date is null group by systype2_name,user_nick;
----按专业未处理工单量
select systype2_name,count(*) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and end_date is null group by systype2_name;
----移网按人未处理工单量
select user_nick,count(*) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and end_date is null and systype2_='1274' group by user_nick;

----今日按人工单量（包括未处理），减掉未处理增加and end_date is not null
select user_nick,count(distinct demand_id) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and to_char(start_date,'yyyymmdd')=to_char(sysdate,'yyyymmdd') group by user_nick;
----按人处理工单量，增加专业（包括未处理）
select systype2_name,user_nick,count(distinct demand_id) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and to_char(start_date,'yyyymmdd')=to_char(sysdate,'yyyymmdd') group by systype2_name,user_nick;
----按专业处理工单量（包括未处理）
select systype2_name,count(*) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and to_char(start_date,'yyyymmdd')=to_char(sysdate,'yyyymmdd') group by systype2_name;
----移网按人处理工单量（包括未处理）
select user_nick,count(*) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and to_char(start_date,'yyyymmdd')=to_char(sysdate,'yyyymmdd') and systype2_='1274' group by user_nick;
----前一天按人工单量（包括未处理）
select user_nick,count(distinct demand_id) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and to_char(start_date,'yyyymmdd')=to_char(sysdate-1,'yyyymmdd') group by user_nick;
----前一天按专业处理工单量（包括未处理）
select systype2_name,count(*) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW where circle_id='12003' and to_char(start_date,'yyyymmdd')=to_char(sysdate-1,'yyyymmdd') group by systype2_name;


----按天统计
select to_char(start_date,'yyyymmdd'),count(distinct demand_id) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW 
where circle_id='12003' and start_date>sysdate-60 group by to_char(start_date,'yyyymmdd') order by to_char(start_date,'yyyymmdd');

----按月统计工单
select to_char(start_date,'yyyymm'),count(distinct demand_id) from unicom_oop.CIRCLERELEVANCEDEMAND_VIEW 
where circle_id='12003' and start_date>sysdate-60 group by to_char(start_date,'yyyymm') order by to_char(start_date,'yyyymm');

